<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Game On</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="./style.css?v=17" />
    <style>
      /* Landing overlay (kept ‚Äî hero you liked) */
      .landing {
        position: fixed;
        inset: 0;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        background: radial-gradient(circle at 30% 30%, #132238 0%, #0f172a 70%);
        color: var(--text);
      }
      .landing.hide { display: none; }

      .landing-nav {
        position: sticky;
        top: 0;
        z-index: 10;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: clamp(0.75rem, 2vw, 1.1rem) clamp(1rem, 3vw, 2rem);
        background: linear-gradient(180deg, rgba(2, 6, 23, 0.85), rgba(2, 6, 23, 0));
        border-bottom: 1px solid rgba(255,255,255,0.06);
        backdrop-filter: blur(10px);
      }
      .brand {
        display: flex; align-items: center; gap: .6rem;
        font-weight: 800; letter-spacing: .8px; font-size: clamp(1.1rem, 2vw, 1.35rem);
      }
      .brand .dot {
        width: 10px; height: 10px; border-radius: 999px; background: var(--accent);
        box-shadow: 0 0 18px var(--accent);
      }
      .landing-actions { display: flex; align-items: center; gap: .6rem; }
      .btn.sm { padding: .5rem .85rem; font-size: .9rem; border-radius: 11px; }

      .landing-hero {
        position: relative;
        display: grid;
        grid-template-columns: 1.3fr 1fr;
        gap: clamp(1rem, 3vw, 2rem);
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: clamp(1rem, 3vw, 2rem);
        flex: 1;
        width: 100%;
      }
      .hero-copy { padding: clamp(.5rem, 2vw, 1rem); position: relative; z-index: 1; }
      .eyebrow {
        color: var(--text-dim); text-transform: uppercase; letter-spacing: .35em;
        font-weight: 700; font-size: .72rem; margin-bottom: .6rem;
      }
      .title { margin: 0 0 .5rem; font-size: clamp(1.8rem, 4.5vw, 3rem); line-height: 1.15; font-weight: 800; }
      .lead { color: var(--text-dim); font-size: clamp(.95rem, 2.2vw, 1.05rem); line-height: 1.65; margin: 0 0 1rem; }
      .cta { display: flex; gap: .6rem; flex-wrap: wrap; margin-top: .6rem; }

      .hero-card {
        background: var(--card);
        border: 1px solid var(--card-border);
        border-radius: 16px;
        padding: clamp(.9rem, 2.5vw, 1.25rem);
        box-shadow: var(--shadow-strong);
        position: relative;
        overflow: hidden;
        z-index: 1;
      }
      .hero-grid { display: grid; gap: .75rem; grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .feature {
        background: linear-gradient(145deg, rgba(255,255,255,0.06), rgba(255,255,255,0.015));
        border: 1px solid var(--card-border);
        border-radius: 12px;
        padding: .8rem .9rem;
      }
      .feature h4 { margin: 0 0 .25rem; font-size: .95rem; letter-spacing: .3px; }
      .muted { color: var(--text-dim); font-size: .9rem; line-height: 1.5; }

      .bg-vectors { pointer-events: none; position: absolute; inset: 0; overflow: hidden; z-index: 0; }
      .blob {
        position: absolute; filter: blur(30px); opacity: .35; mix-blend-mode: screen;
        animation: float 16s ease-in-out infinite; will-change: transform;
      }
      .blob.one {
        width: 480px; height: 480px; right: -120px; top: -80px;
        background: radial-gradient(circle at 30% 30%, #3b82f6, rgba(59,130,246,0) 60%),
                    radial-gradient(circle at 70% 70%, #10b981, rgba(16,185,129,0) 55%);
        animation-delay: 0s;
      }
      .blob.two {
        width: 420px; height: 420px; left: -100px; bottom: -100px;
        background: radial-gradient(circle at 40% 40%, #f59e0b, rgba(245,158,11,0) 60%),
                    radial-gradient(circle at 70% 30%, #22d3ee, rgba(34,211,238,0) 55%);
        animation-delay: -4s;
      }
      .orb {
        position: absolute; width: 12px; height: 12px; border-radius: 999px;
        background: #93c5fd; box-shadow: 0 0 14px #93c5fd;
        animation: drift 10s linear infinite; opacity: .65;
      }
      .orb.a { left: 8%; top: 35%; animation-duration: 13s; }
      .orb.b { left: 28%; top: 15%; animation-duration: 11s; }
      .orb.c { right: 22%; top: 20%; animation-duration: 12s; }
      .orb.d { right: 15%; bottom: 18%; animation-duration: 14s; }
      @keyframes float { 0%,100%{transform:translateY(0) scale(1)} 50%{transform:translateY(-22px) scale(1.03)} }
      @keyframes drift { 0%{transform:translateY(0) translateX(0)} 50%{transform:translateY(-22px) translateX(10px)} 100%{transform:translateY(0) translateX(0)} }

      .grid {
        position: absolute; inset: 0;
        background-image:
          linear-gradient(to right, rgba(255,255,255,.04) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(255,255,255,.04) 1px, transparent 1px);
        background-size: 40px 40px;
        mask-image: radial-gradient(ellipse at center, rgba(0,0,0,.5), transparent 70%);
        pointer-events: none;
      }

      .landing-footer {
        text-align: center; color: var(--text-dim); font-size: .8rem;
        padding: 1.2rem 1rem 1.8rem;
      }

      @media (max-width: 900px) {
        .landing-hero { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <!-- Landing overlay -->
    <div id="landing" class="landing" role="dialog" aria-label="Game On landing">
      <div class="bg-vectors" aria-hidden="true">
        <div class="blob one"></div>
        <div class="blob two"></div>
        <div class="orb a"></div>
        <div class="orb b"></div>
        <div class="orb c"></div>
        <div class="orb d"></div>
        <div class="grid"></div>
      </div>

      <nav class="landing-nav">
        <div class="brand">
          <span class="dot" aria-hidden="true"></span>
          <span>GAME ON</span>
        </div>
        <div class="landing-actions">
          <a class="btn sm" href="../server/leaderboard.php">Leaderboard</a>
          <a class="btn primary sm" href="#" data-enter>Login</a>
        </div>
      </nav>

      <header class="landing-hero" role="banner">
        <div class="hero-copy">
          <div class="eyebrow">Arcade survival</div>
          <h1 class="title">Dash. Collect. Survive. Face a mini‚Äëboss every 6 levels.</h1>
          <p class="lead">
            Game On is a fast, stylish browser arcade where you weave through hazards,
            chain orb combos, and use power‚Äëups to outlast the clock. Master the dash,
            build score multipliers, and defeat escalating mini‚Äëbosses.
          </p>
          <div class="cta">
            <a class="btn accent" href="#" data-enter>Play Now</a>
            <a class="btn" href="../server/leaderboard.php">View Leaderboard</a>
          </div>
        </div>

        <aside class="hero-card">
          <div class="hero-grid">
            <div class="feature">
              <h4>Mini‚ÄëBoss Rounds</h4>
              <p class="muted">Every 6 levels brings a boss with radial bursts, aimed shots, and a gentle enrage.</p>
            </div>
            <div class="feature">
              <h4>Combo Orbs</h4>
              <p class="muted">Collect orbs fast to grow your combo and rack up massive points with a 2x multiplier.</p>
            </div>
            <div class="feature">
              <h4>Power‚ÄëUps</h4>
              <p class="muted">Shield, slow‚Äëtime, healing, and score boost help you survive and score higher.</p>
            </div>
            <div class="feature">
              <h4>Skillful Dash</h4>
              <p class="muted">Invulnerable dash to dodge bullets, damage enemies, and even chunk the boss.</p>
            </div>
          </div>
        </aside>
      </header>

      <footer class="landing-footer">
        <div>&copy; 2025 Game On ‚Äî Built by Adarsh R</div>
      </footer>
    </div>
    <!-- End landing overlay -->

    <!-- App nav -->
    <header class="app-nav" role="navigation" aria-label="Game On navigation">
      <div class="nav-inner">
        <div class="brand">
          <span class="dot" aria-hidden="true"></span>
          <span>GAME ON</span>
        </div>
        <div class="nav-actions">
          <a class="btn glass sm" href="../server/leaderboard.php">Leaderboard</a>
          <button id="homeBtn" class="btn glass sm" title="Home">
            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path fill="currentColor" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            <span>Home</span>
          </button>
        </div>
      </div>
    </header>

    <!-- AUTH SECTION -->
    <section id="authSection" class="center-wrapper">
      <div id="authCard" class="auth-card" aria-live="polite">
        <div class="auth-head">
          <div class="ring"><span class="ring-core"></span></div>
          <div>
            <h2 class="auth-title">Welcome Back</h2>
            <p class="auth-sub">Sign in to continue your arcade adventure</p>
          </div>
        </div>

        <div class="auth-tabs" role="tablist">
          <button class="auth-tab active" data-tab="login" id="tab-login" aria-selected="true">Login</button>
          <button class="auth-tab" data-tab="register" id="tab-register" aria-selected="false">Register</button>
        </div>

        <div class="auth-panels">
          <form id="loginForm" class="auth-form active" autocomplete="on">
            <div class="field">
              <label for="loginUsername">Username</label>
              <input id="loginUsername" name="username" type="text" maxlength="50" required autocomplete="username" />
            </div>
            <div class="field">
              <label for="loginPassword">Password</label>
              <input id="loginPassword" name="password" type="password" maxlength="72" required autocomplete="current-password" />
            </div>
            <div class="form-footer">
              <button id="loginSubmit" type="submit" class="btn primary w-full glow">Sign In</button>
              <p class="switch-hint">No account?
                <button type="button" class="link-btn" data-switch="register">Create one</button>
              </p>
            </div>
          </form>

          <form id="registerForm" class="auth-form" autocomplete="on">
            <div class="field">
              <label for="regUsername">Username</label>
              <input id="regUsername" name="username" type="text" maxlength="50" required autocomplete="username" />
            </div>
            <div class="field">
              <label for="regPassword">Password <span class="note">(min 6 chars)</span></label>
              <input id="regPassword" name="password" type="password" minlength="6" maxlength="72" required autocomplete="new-password" />
            </div>
            <div class="field">
              <label for="regPassword2">Confirm Password</label>
              <input id="regPassword2" name="password2" type="password" minlength="6" maxlength="72" required autocomplete="new-password" />
            </div>
            <div class="form-footer">
              <button id="registerSubmit" type="submit" class="btn accent w-full glow">Create Account</button>
              <p class="switch-hint">Already have an account?
                <button type="button" class="link-btn" data-switch="login">Sign in</button>
              </p>
            </div>
          </form>
        </div>

        <div id="authMessage" class="auth-message" aria-live="polite"></div>
      </div>
    </section>

    <!-- GAME SECTION -->
    <main id="gameSection" class="game-wrapper" style="display: none">
      <div class="top-bar">
        <div class="user-badge">
          <span id="loggedUser"></span>
        </div>
        <div class="game-actions">
          <button id="startBtn" class="btn primary">Start</button>
          <button id="restartBtn" class="btn" disabled>Restart</button>
          <button id="storeBtn" class="btn accent">Store</button>
          <a class="btn" href="../server/leaderboard.php">Leaderboard</a>
          <button id="logoutBtn" class="btn danger">Logout</button>
        </div>
      </div>

      <div id="canvasWrap" class="canvas-wrap">
        <canvas id="game" width="640" height="480"></canvas>
      </div>
      <div id="status" class="status-bar"></div>
    </main>

    <footer class="site-footer">
      <p>&copy; 2025 Game On</p>
    </footer>

    <!-- Store Modal (Demo purchases) -->
    <div id="storeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="storeTitle" aria-hidden="true">
      <div class="modal-backdrop" data-close-store></div>
      <div class="modal-card store-card" role="document">
        <div class="modal-head">
          <h3 id="storeTitle" class="modal-title">In‚ÄëGame Store <span class="badge-demo">Demo</span></h3>
          <button class="btn glass sm" title="Close" data-close-store>&times;</button>
        </div>
        <p class="modal-sub">Try purchasing items below. This is a demo ‚Äî no real transactions.</p>
        <div class="store-grid">
          <div class="store-item">
            <div class="icon">‚ù§Ô∏è</div>
            <div class="meta">
              <h4>Health +1</h4>
              <p>Get an extra heart to keep fighting.</p>
            </div>
            <div class="buy">
              <span class="price">‚Çπ49</span>
              <button class="btn primary sm buy-btn" data-item="Health +1">Buy</button>
            </div>
          </div>
          <div class="store-item">
            <div class="icon">üõ°Ô∏è</div>
            <div class="meta">
              <h4>Shield</h4>
              <p>Absorb the next hit automatically.</p>
            </div>
            <div class="buy">
              <span class="price">‚Çπ59</span>
              <button class="btn primary sm buy-btn" data-item="Shield">Buy</button>
            </div>
          </div>
          <div class="store-item">
            <div class="icon">‚è≠Ô∏è</div>
            <div class="meta">
              <h4>Skip Level</h4>
              <p>Jump straight to the next level.</p>
            </div>
            <div class="buy">
              <span class="price">‚Çπ79</span>
              <button class="btn primary sm buy-btn" data-item="Skip Level">Buy</button>
            </div>
          </div>
          <div class="store-item">
            <div class="icon">‚ú®</div>
            <div class="meta">
              <h4>Regen Boost</h4>
              <p>Gradually recover a heart over time.</p>
            </div>
            <div class="buy">
              <span class="price">‚Çπ69</span>
              <button class="btn primary sm buy-btn" data-item="Regen Boost">Buy</button>
            </div>
          </div>
        </div>
        <div class="modal-foot">
          <small class="muted">Purchases are disabled in this demo build.</small>
        </div>
      </div>
    </div>

    <script src="./game.js?v=13" defer></script>

    <script>
      // Landing overlay controller: hide on Login/Play, auto-hide if already signed in
      (function () {
        const landing = document.getElementById('landing');
        function enter() {
          landing && landing.classList.add('hide');
          setTimeout(() => {
            const u = document.getElementById('loginUsername');
            if (u) u.focus();
          }, 0);
        }
        document.querySelectorAll('[data-enter]').forEach(el => {
          el.addEventListener('click', (e) => { e.preventDefault(); enter(); });
        });
        try {
          if (localStorage.getItem('username')) enter();
        } catch (_) {}
      })();

      // Home -> show landing
      (function () {
        const home = document.getElementById('homeBtn');
        const landing = document.getElementById('landing');
        if (!home || !landing) return;
        home.addEventListener('click', (e) => {
          e.preventDefault();
          landing.classList.remove('hide');
          setTimeout(() => {
            const first = landing.querySelector('[data-enter]') || landing.querySelector('a,button');
            if (first) first.focus();
          }, 0);
        });
      })();

      // Store modal (demo)
      (function () {
        const modal = document.getElementById('storeModal');
        const openBtn = document.getElementById('storeBtn');
        if (!modal || !openBtn) return;

        function openStore() {
          modal.setAttribute('aria-hidden','false');
          modal.classList.add('open');
          document.dispatchEvent(new CustomEvent('game:pause'));
          const firstBuy = modal.querySelector('.buy-btn');
          firstBuy && firstBuy.focus();
        }
        function closeStore() {
          modal.classList.remove('open');
          modal.setAttribute('aria-hidden','true');
          document.dispatchEvent(new CustomEvent('game:resume'));
          openBtn && openBtn.focus();
        }

        openBtn.addEventListener('click', (e) => { e.preventDefault(); openStore(); });
        modal.addEventListener('click', (e) => {
          if (e.target && e.target.closest('[data-close-store]')) closeStore();
        });
        document.addEventListener('keydown', (e) => {
          if (!modal.classList.contains('open')) return;
          if (e.key === 'Escape') closeStore();
        });
        modal.addEventListener('click', (e) => {
          if (e.target === modal.querySelector('.modal-backdrop')) closeStore();
        });

        modal.querySelectorAll('.buy-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const item = btn.getAttribute('data-item') || 'Item';
            alert(`Demo purchase\\n\\nPurchases are disabled in this demo build.\\nYou tapped: ${item}`);
          });
        });
      })();
    </script>
  </body>
</html>